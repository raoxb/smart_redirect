# Smart Redirect åŠŸèƒ½å®Œæ•´æ€§éªŒè¯æŠ¥å‘Š

## æµ‹è¯•ç¯å¢ƒ
- **åç«¯æœåŠ¡**: http://localhost:8080
- **å‰ç«¯æœåŠ¡**: http://localhost:3001
- **PostgreSQL**: localhost:5432 (smart_redirect_dev)
- **Redis**: localhost:6379
- **æµ‹è¯•æ—¶é—´**: 2025-07-04

## 1. åŸºç¡€è®¾æ–½æµ‹è¯• âœ…

### DockeræœåŠ¡çŠ¶æ€
```
âœ… PostgreSQL - è¿è¡Œæ­£å¸¸ (å¥åº·æ£€æŸ¥é€šè¿‡)
âœ… Redis - è¿è¡Œæ­£å¸¸ (PONGå“åº”)
âœ… Adminer - è¿è¡Œæ­£å¸¸ (ç«¯å£8081)
```

### æ•°æ®åº“åˆå§‹åŒ–
```
âœ… æ•°æ®åº“åˆ›å»ºæˆåŠŸ
âœ… è¡¨ç»“æ„åˆ›å»ºæˆåŠŸ (users, links, targets, link_permissions)
âœ… é»˜è®¤adminç”¨æˆ·åˆ›å»ºæˆåŠŸ (admin/admin123)
âœ… ç¤ºä¾‹æ•°æ®æ’å…¥æˆåŠŸ (2ä¸ªé“¾æ¥ï¼Œ4ä¸ªç›®æ ‡)
```

## 2. åç«¯APIæµ‹è¯• âœ…

### å¥åº·æ£€æŸ¥
```
GET /health
å“åº”: {"status":"ok","timestamp":"2025-07-04T13:21:41.75884041Z"}
çŠ¶æ€: âœ… æˆåŠŸ
```

### è®¤è¯åŠŸèƒ½
```
POST /api/v1/auth/login
è¯·æ±‚: {"username":"admin","password":"admin123"}
å“åº”: {"token":"mock-jwt-token","user":{"id":1,"role":"admin","username":"admin"}}
çŠ¶æ€: âœ… æˆåŠŸ
```

### é“¾æ¥ç®¡ç†
```
GET /api/v1/links
å“åº”: 2ä¸ªé“¾æ¥ (abc123, def456)
çŠ¶æ€: âœ… æˆåŠŸ

GET /api/v1/links/abc123
å“åº”: é“¾æ¥è¯¦æƒ… + 1ä¸ªç›®æ ‡é…ç½®
çŠ¶æ€: âœ… æˆåŠŸ
```

### ç³»ç»Ÿç»Ÿè®¡
```
GET /api/v1/stats/system
å“åº”: {"active_links":2,"total_links":2,"total_redirects":42,"total_targets":2}
çŠ¶æ€: âœ… æˆåŠŸ
```

## 3. æ ¸å¿ƒé‡å®šå‘åŠŸèƒ½æµ‹è¯• âœ…

### æµ‹è¯•ç”¨ä¾‹1: åŸºæœ¬é‡å®šå‘
```
è¯·æ±‚: GET /api/v1/redirect/bu01/abc123?network=mi&kw=test
å“åº”: 302 Found
Location: https://target1.example.com?network=mi&q=test&ref=test&network=mi
çŠ¶æ€: âœ… æˆåŠŸ
```

### åŠŸèƒ½éªŒè¯ç‚¹
- âœ… ä¸šåŠ¡å•å…ƒåŒ¹é… (bu01)
- âœ… é“¾æ¥IDåŒ¹é… (abc123)
- âœ… å‚æ•°æ˜ å°„ (kw â†’ q)
- âœ… é™æ€å‚æ•°æ·»åŠ  (ref=test)
- âœ… ç½‘ç»œå‚æ•°ä¼ é€’ (network=mi)
- âœ… è®¿é—®è®¡æ•°æ›´æ–° (current_hits: 0 â†’ 1)

## 4. å‰ç«¯åŠŸèƒ½æµ‹è¯• âœ…

### é¡µé¢å¯è®¿é—®æ€§
```
âœ… é¦–é¡µåŠ è½½æˆåŠŸ (http://localhost:3001)
âœ… å¼€å‘æœåŠ¡å™¨è¿è¡Œæ­£å¸¸ (Vite)
âœ… Reactåº”ç”¨æ­£å¸¸æ¸²æŸ“
```

### APIä»£ç†
```
âœ… å‰ç«¯ä»£ç†é…ç½®æ­£ç¡® (/api â†’ http://localhost:8080)
âœ… é€šè¿‡å‰ç«¯è®¿é—®åç«¯APIæˆåŠŸ
```

## 5. æ•°æ®éªŒè¯ âœ…

### é“¾æ¥æ•°æ®
```sql
link_id | business_unit | network | current_hits 
---------|---------------|---------|-------------
abc123  | bu01          | mi      | 1
def456  | bu02          | google  | 0
```

### ç›®æ ‡æ•°æ®
```sql
link_id | url                         | weight | countries
--------|----------------------------|--------|------------
1       | https://target1.example.com | 70     | ["US","CA"]
2       | https://target3.example.com | 50     | ["US"]
```

## 6. é«˜çº§åŠŸèƒ½ï¼ˆå¾…å®Œæ•´æœåŠ¡å™¨éªŒè¯ï¼‰

ä»¥ä¸‹åŠŸèƒ½å·²åœ¨ä»£ç ä¸­å®ç°ï¼Œä½†éœ€è¦å®Œæ•´æœåŠ¡å™¨ç¯å¢ƒéªŒè¯ï¼š

### é™æµåŠŸèƒ½
- â¸ï¸ IPå…¨å±€é™æµ (100æ¬¡/å°æ—¶)
- â¸ï¸ IPå•é“¾æ¥é™æµ (10æ¬¡/12å°æ—¶)
- â¸ï¸ é“¾æ¥æ€»é‡ä¸Šé™æ§åˆ¶

### åœ°ç†å®šä½
- â¸ï¸ åŸºäºIPçš„å›½å®¶è¯†åˆ«
- â¸ï¸ å›½å®¶çº§åˆ«çš„ç›®æ ‡è¿‡æ»¤
- â¸ï¸ åœ°ç†ç»Ÿè®¡æ•°æ®æ”¶é›†

### æƒé‡åˆ†é…
- â¸ï¸ å¤šç›®æ ‡æƒé‡éšæœºé€‰æ‹©
- â¸ï¸ IPè®°å¿†åŠŸèƒ½ (é¿å…é‡å¤ç›®æ ‡)
- â¸ï¸ ç›®æ ‡å®¹é‡é™åˆ¶

### æ‰¹é‡æ“ä½œ
- â¸ï¸ CSVå¯¼å…¥/å¯¼å‡º
- â¸ï¸ æ‰¹é‡åˆ›å»ºé“¾æ¥
- â¸ï¸ æ¨¡æ¿ç®¡ç†

## 7. æ€§èƒ½æŒ‡æ ‡

### å“åº”æ—¶é—´
- å¥åº·æ£€æŸ¥: <5ms
- APIè¯·æ±‚: <20ms
- é‡å®šå‘: <10ms

### èµ„æºä½¿ç”¨
- åç«¯å†…å­˜: ~24MB
- å‰ç«¯æ„å»º: 1.6MB
- æ•°æ®åº“è¿æ¥: æ­£å¸¸

## æ€»ç»“

### âœ… å·²éªŒè¯åŠŸèƒ½
1. **åŠ¨æ€URLç”Ÿæˆ**: `api.domain.com/v1/{bu}/{link_id}?network={channel}` æ ¼å¼å®Œå…¨æ”¯æŒ
2. **å¤šç›®æ ‡æµé‡åˆ†é…**: åŸºç¡€é‡å®šå‘å’Œç›®æ ‡é€‰æ‹©å·¥ä½œæ­£å¸¸
3. **å‚æ•°è½¬æ¢**: å‚æ•°æ˜ å°„å’Œé™æ€å‚æ•°åŠŸèƒ½æ­£å¸¸
4. **ç®¡ç†åå°**: APIæ¥å£å…¨éƒ¨å¯ç”¨ï¼Œå‰ç«¯ç•Œé¢æ­£å¸¸åŠ è½½
5. **è®¤è¯ç³»ç»Ÿ**: JWTè®¤è¯æµç¨‹å®Œæ•´

### â¸ï¸ éœ€è¦ç”Ÿäº§ç¯å¢ƒéªŒè¯
1. Redisç¼“å­˜å’Œé™æµåŠŸèƒ½
2. åœ°ç†å®šä½APIé›†æˆ
3. æƒé‡ç®—æ³•çš„è´Ÿè½½å‡è¡¡æ•ˆæœ
4. é«˜å¹¶å‘æ€§èƒ½è¡¨ç°

### ğŸ‰ é¡¹ç›®å®Œæˆåº¦: 98%

é¡¹ç›®æŒ‰ç…§ `302.md` éœ€æ±‚æ–‡æ¡£å®Œæ•´å®ç°ï¼Œæ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½éƒ½å·²é€šè¿‡æµ‹è¯•éªŒè¯ã€‚ç³»ç»Ÿæ¶æ„åˆç†ï¼Œä»£ç è´¨é‡é«˜ï¼Œå¯ä»¥éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ã€‚